left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba), color = 'blue') +
geom_line(aes(y = pts_aba), color = 'red') +
theme_minimal()
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba), color = 'blue') +
geom_line(aes(y = pts_aba), color = 'red') +
theme_minimal() +
scale_color_identity()
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba), color = 'blue') +
geom_line(aes(y = pts_aba), color = 'red') +
theme_minimal() +
scale_color_manual(name = 'League')
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba), color = 'blue') +
geom_line(aes(y = pts_aba), color = 'red') +
theme_minimal() +
scale_color_manual(name = 'League', values = c('blue'='blue','red'='red'), labels = c('NBA','ABA'))
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba), color = 'blue') +
geom_line(aes(y = pts_aba), color = 'red') +
# theme_minimal() +
scale_color_manual(name = 'League', values = c('blue'='blue','red'='red'), labels = c('NBA','ABA'))
# geom_hline(yintercept = nbapts %>% filter(szn == 2019) %>% select(pts) %>% first(), color = 'blue')
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba, color = 'blue')) +
geom_line(aes(y = pts_aba, color = 'red')) +
# theme_minimal() +
scale_color_manual(name = 'League', values = c('blue'='blue','red'='red'), labels = c('NBA','ABA'))
# geom_hline(yintercept = nbapts %>% filter(szn == 2019) %>% select(pts) %>% first(), color = 'blue')
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba, color = 'blue')) +
geom_line(aes(y = pts_aba, color = 'red')) +
# theme_minimal() +
scale_color_manual(name = 'League', values = c('blue'='blue','red'='red'), labels = c('NBA','ABA')) +
xlab("Season") +
ylab("Points per game") +
# geom_hline(yintercept = nbapts %>% filter(szn == 2019) %>% select(pts) %>% first(), color = 'blue')
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba, color = 'blue')) +
geom_line(aes(y = pts_aba, color = 'red')) +
# theme_minimal() +
scale_color_manual(name = 'League', values = c('blue'='blue','red'='red'), labels = c('NBA','ABA')) +
xlab("Season") +
ylab("Points per game")
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba, color = 'blue')) +
geom_line(aes(y = pts_aba, color = 'red')) +
# theme_minimal() +
scale_color_manual(name = 'League', values = c('blue'='blue','red'='red'), labels = c('NBA','ABA')) +
xlab("Season") +
ylab("Points per game")
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba, color = 'blue')) +
geom_line(aes(y = pts_aba, color = 'red')) +
# theme_minimal() +
scale_color_manual(name = 'League', values = c('blue'='blue','red'='red'), labels = c('NBA','ABA')) +
xlab("Season") +
ylab("Points per game") +
ggtitle("Scoring average by season") +
theme_minimal()
library(tidyverse)
library(readxl)
data = read_csv('time-to-100.csv')
data %>%
ggplot(aes(timeto100, year)) +
geom_point() +
ggtitle("NBA games are hitting the 100-point mark earlier and earlier") +
scale_x_reverse(
name = "Time at which the first team hits 100 points",
breaks = rev(0:8*60),
limits = c(8*60,0),
labels = c('8 minutes\nleft in game','7 min.','6 min.','5 min.','4 min.','3 min.','2 min.','1 min.','End of game'),
minor_breaks = NULL
) +
scale_y_reverse(
name = "Season",
breaks = 2019:1997,
limits = c(2019,1997),
labels = 2019:1997,
minor_breaks = NULL
) +
theme_minimal()
trends = read_csv('law-by-year.csv')
p1 = trends %>%
ggplot(aes(year, pct_games_invoked * 100)) +
geom_line() +
theme_minimal() +
xlab("Season") +
ylab("Percent of games where a team hits 100 points") +
ggtitle("As more NBA games cross the 100-point barrier ...")
p1
p2 = trends %>%
ggplot(aes(year, pct_law_correct * 100)) +
geom_line() +
theme_minimal() +
xlab("Season") +
ylab("Percent of games Lawler's Law holds true") +
ggtitle("... Lawler's Law has become less accurate")
p2
gridExtra::grid.arrange(p1, p2, ncol = 1)
nba = read_csv('nba_stats.csv')
aba = read_csv('aba_stats.csv')
nbapts = nba %>%
select(szn = Season, pts = PTS) %>%
mutate(szn = as.integer(str_sub(szn, end=4)) + 1)
abapts = aba %>%
select(szn = Season, pts = PTS) %>%
mutate(szn = as.integer(str_sub(szn, end=4)) + 1)
nbapts %>%
left_join(abapts, by='szn', suffix = c('_nba','_aba')) %>%
ggplot(aes(szn)) +
geom_line(aes(y = pts_nba, color = 'blue')) +
geom_line(aes(y = pts_aba, color = 'red')) +
# theme_minimal() +
scale_color_manual(name = 'League', values = c('blue'='blue','red'='red'), labels = c('NBA','ABA')) +
xlab("Season") +
ylab("Points per game") +
ggtitle("Scoring average by season") +
theme_minimal()
# geom_hline(yintercept = nbapts %>% filter(szn == 2019) %>% select(pts) %>% first(), color = 'blue')
library(tidyverse)
firsttox = read_csv('point-tables.csv')
View(firsttox)
View(firsttox)
firsttox
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point()
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2))
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x)
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3) + I(x^4))
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5))
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
ggplot(aes(point, pct_correct)) +
geom_point()
firsttox %>%
ggplot(aes(point, pct_correct, color = year)) +
geom_point()
firsttox %>%
ggplot(aes(point, pct_correct, color = year)) +
geom_point(aes(alpha = 0.5))
firsttox %>%
ggplot(aes(point, pct_correct, color = year)) +
geom_point(alpha = 0.5)
firsttox %>%
ggplot(aes(point, pct_correct, color = year)) +
geom_point(alpha = 0.2)
firsttox %>%
filter(year == 1997 | year == 2018)
firsttox %>%
filter(year == 1997 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = year))
firsttox %>%
filter(year == 1997 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year)))
firsttox %>%
filter(year == 1997 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year))) +
geom_point()
firsttox %>%
filter(year == 1997 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year))) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
mutate(pre = (year < 2017))
firsttox %>%
mutate(pre = (year < 2017)) %>%
tail()
firsttox %>%
mutate(pre = (year < 2017)) %>%
group_by(year, point) %>%
summarise(games = sum(games), correct = sum(correct))
firsttox %>%
mutate(pre = (year < 2017)) %>%
group_by(pre, point) %>%
summarise(games = sum(games), correct = sum(correct))
firsttox %>%
mutate(pre = (year < 2017)) %>%
group_by(pre, point) %>%
summarise(games = sum(games), correct = sum(correct)) %>%
mutate(pct_correct = correct / games)
firsttox %>%
mutate(pre = (year < 2017)) %>%
group_by(pre, point) %>%
summarise(games = sum(games), correct = sum(correct)) %>%
mutate(pct_correct = correct / games) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year))) +
geom_point()
firsttox %>%
mutate(pre = (year < 2017)) %>%
group_by(pre, point) %>%
summarise(games = sum(games), correct = sum(correct)) %>%
mutate(pct_correct = correct / games) %>%
ggplot(aes(point, pct_correct, shape = pre)) +
geom_point()
firsttox %>%
mutate(pre = (year < 2017)) %>%
group_by(pre, point) %>%
summarise(games = sum(games), correct = sum(correct)) %>%
mutate(pct_correct = correct / games) %>%
ggplot(aes(point, pct_correct, shape = pre)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
mutate(pre = (year < 2017)) %>%
group_by(pre, point) %>%
summarise(games = sum(games), correct = sum(correct)) %>%
mutate(pct_correct = correct / games) %>%
ggplot(aes(point, pct_correct, shape = pre)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
mutate(pre = (year < 2017)) %>%
group_by(pre, point) %>%
summarise(games = sum(games), correct = sum(correct)) %>%
mutate(pct_correct = correct / games) %>%
ggplot(aes(point, pct_correct, shape = pre)) +
# geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
mutate(pre = (year < 2008)) %>%
group_by(pre, point) %>%
summarise(games = sum(games), correct = sum(correct)) %>%
mutate(pct_correct = correct / games) %>%
ggplot(aes(point, pct_correct, shape = pre)) +
# geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year))) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
model99 = lm(
pct_correct ~ point + I(point^2) + I(point^3),
data = firsttox %>% filter(year == 1999)
)
firsttox %>%
filter(year == 1999) %>%
mutate(pred = predict(model99))
firsttox %>%
filter(year == 1999) %>%
mutate(pred = predict(model99)) %>%
filter(point == 100)
model19 = lm(
pct_correct ~ point + I(point^2) + I(point^3),
data = firsttox %>% filter(year == 2019)
)
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19))
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19)) %>%
arrange(point) %>%
filter(pred >= 0.9591816)
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19)) %>%
arrange(point) %>%
filter(point < 130 & point > 110)
firsttox %>%
mutate(pre = (year < 2008)) %>%
group_by(pre, point) %>%
summarise(games = sum(games), correct = sum(correct)) %>%
mutate(pct_correct = correct / games) %>%
ggplot(aes(point, pct_correct, shape = pre)) +
geom_point() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
pred99 = firsttox %>%
filter(year == 1999) %>%
mutate(pred = predict(model99))
pred99 %>%
ggplot(aes(point, pct_correct))
pred99 %>%
ggplot(aes(point, pct_correct)) +
geom_point()
pred99 %>%
select(point, pct_correct, pred)
pred99 %>%
select(point, pct_correct, pred) %>%
gather(point, type, -point)
pred99 %>%
select(point, pct_correct, pred) %>%
gather(point, type, pct_correct, pred)
iris %>%
group_by(Species) %>%
iris %>%
group_by(Species) %>%
slice(1)
library(dplyr)
iris %>%
group_by(Species) %>% slice(1)
iris %>%
group_by(Species) %>% slice(1) %>% gather(key = flower_att, value = measurement, -Species)
pred99 %>%
select(point, pct_correct, pred) %>%
gather(pred_type, pct, -point)
pred99 %>%
select(point, pct_correct, pred) %>%
gather(pred_type, pct, -point) %>%
ggplot(aes(point, pct, color = pred_type)) +
geom_point()
pred99 %>%
filter(point == 100)
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19)) %>%
arrange(point) %>%
filter(point < 130 & point > 110) %>%
select(-year)
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19)) %>%
arrange(point) %>%
filter(point < 130 & point > 110) %>%
select(-year) %>%
filter(games > 260 & games < 270)
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19)) %>%
arrange(point) %>%
filter(point < 130 & point > 110) %>%
select(-year)
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19)) %>%
arrange(point)%>%
filter(games > 260 & games < 270)
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19)) %>%
arrange(point)%>%
filter(games > 255 & games < 275)
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19)) %>%
arrange(point) %>%
View()
pred99 %>%
filter(point > 98 & point < 102)
firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19)) %>%
arrange(point) %>%
filter(pred > 0.95 & pred < 0.97)
pred99 %>%
filter(point == 100)
pred99 %>%
filter(point == 100) %>%
pull(pred)
pred19 = firsttox %>%
filter(year == 2019) %>%
mutate(pred = predict(model19))
pred19 %>%
arrange(point) %>%
filter(pred >= pred99 %>% filter(point == 100) %>% pull(pred))
pred99
pred99 %>%
filter(point == 100)
pred19 %>%
select(point, pct_correct, pred) %>%
gather(pred_type, pct, -point) %>%
ggplot(aes(point, pct, color = pred_type)) +
geom_point()
pred19 %>%
arrange(point) %>%
filter(pred >= pred99 %>% filter(point == 100) %>% pull(pred)) %>%
slice(1)
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3))
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3)) +
geom_vline(121)
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3)) +
geom_vline(xintercept = 121)
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3)) +
geom_vline(xintercept = 121) +
geom_hline(yintercept = 0.9591612)
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3)) +
geom_vline(xintercept = 119) +
geom_hline(yintercept = 0.9591612)
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3)) +
geom_vline(xintercept = 118) +
geom_hline(yintercept = 0.9591612)
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3)) +
geom_vline(xintercept = 119) +
geom_hline(yintercept = 0.9591612)
firsttox %>%
filter(year == 1998 | year == 2018) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3)) +
geom_vline(xintercept = 118) +
geom_hline(yintercept = 0.9591612)
pred19 %>%
arrange(point) %>%
filter(point >= 118) %>%
head()
firsttox %>%
filter(year == 1999 | year == 2019) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3)) +
geom_vline(xintercept = 118) +
geom_hline(yintercept = 0.9591612)
firsttox %>%
filter(year == 1999 | year == 2019) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ x + I(x^2) + I(x^3)) +
geom_vline(xintercept = 121) +
geom_hline(yintercept = 0.9591612)
summary(model99)
firsttox %>%
filter(year == 1999 | year == 2019) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ poly(x, 2)) +
geom_vline(xintercept = 121) +
geom_hline(yintercept = 0.9591612)
firsttox %>%
filter(year == 1999 | year == 2019) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ poly(x,3))
firsttox %>%
filter(year == 1999 | year == 2019) %>%
ggplot(aes(point, pct_correct, shape = as.factor(year), color = as.factor(year))) +
geom_line() +
stat_smooth(method = 'lm', formula = y ~ poly(x,3)) +
geom_vline(xintercept = 121) +
geom_hline(yintercept = 0.9591612)
